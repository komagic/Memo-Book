# 前端相关

## 框架
* [`[Basic]` Vue原理](/vue/vuejs.md)
* [`[Basic]` React原理](/react/react.md)
  
## canvas

### fabric.js
* [`[Basic]` fabric.js常见api](/fabricjs.md)

## 性能优化
* [`[Basic]` web性能优化](/optimize/op.md)


# web常见安全问题
一个典型的web应用，通常以浏览器或客户端app作为入口，通过HTTP访问服务，客户端解析服务返回的内容展现给用户，服务本身会依赖DB及其他服务。

在这个过程中，每一层都可能产生漏洞，被攻击者利用。

## XSS
跨站脚本共计译于Cross Site Script,为避免于层叠样式表混淆，安全领域称之为XSS，根据 攻击过程 是否存在脚本存储分为反射性XSS和存储型XSS。

反射型XSS又称为非持久性XSS，以URL，document.refer、window.opener作为恶意脚本载体，诱导用户点击，发起攻击。加入访问站点xx时候，在页面中直接使用localhost.hash作为页面的输出，攻击者将参数替换为脚本，诱导一个普通用户点击，可以完成一次xss攻击。
产生反射性XSS的关键因素是：
* 攻击者生成诱导用户点击的恶意链接；
* 服务端或客户端直接使用url参数等载体拼装客户端脚本；

存储型xss攻击是借助存在漏洞站点的可存储输入，入留言板，微博动态，在线聊天等，插入恶意脚本，将恶意脚本存储到服务端。存储在服务端的恶意脚本具有“持久生效”的特点，也被称为持久性xss。

存储型xss与反射性xss在端上的表现是一致的，归结为：
* 攻击者输入恶意脚本保存；
* 服务端直接保存用户输入并返回给前端；
* 前端直接使用服务端返回数据瓶装渲染。

### xss危害
* 改变用户正常浏览行为，入恶意弹窗，广告推送等；
* 钓鱼，通过xss在目标站点形成钓鱼操作，对比常规钓鱼网站，诱导性更强；
* cookie劫持，攻击者劫持用户访问的cookie信息，伪装用户登录，窃取用户隐私信息；
* 伪造请求，攻击者通过xss脚本伪造站内请求，进行一些敏感操作；

### xss防范
1. DOM内容输入时安全控制
前端使用innerHTML、document.write、eval、new function时，避免使用URL、document.refer、window.opener作为DOM内容的来源。

2. HTMl Encode
在HTML页面中提交到服务端时，服务端需要对提交内容转义后存储；客户端更新DOM中元素和元素属性时，对更新值进行转义处理。

3. 保证cookie安全
Xss攻击过程中，cookie容易被攻击者利用。首先我们需要避免在cookie中存入敏感信息；在服务端可以设置httpOnly来阻止客户端对cookie的操作。

4. 应用操作流程安全控制
存在用户隐私操作时候，新增用户二次验证的流程。

## CSRF
跨站请求伪造（Cross site Request Forgery）,因为其触发特点又称为单键攻击或会话重置，CSRF通过挟持用户在信任站点登录状态，执行非用户本意操作。
CSRF攻击流程如下：

1. 用户登录可信任站点；
2. 可信任站点设置cookie标识用户会话；
3. 用户访问恶意站点；
4. 恶意站点主动触发一个可以访问可信任站点的地址；

CSRF攻击需要具备的条件：
* 用户在可信任站点登录，生成cookie信息；
* 危险站点能推测出可信任站点地址及参数规则；
* 用户访问危险站点，且B存在诱导用户跳转到a站点的链接；
* 可信任站点没有CSRF防护措施；

### CSRF危害
CSRF攻击成功后，攻击者的权限近似用户。

### CSRF防御
* refer检测
浏览器中发起请求默认会在request Header中携带refer信息，koa中可以使用ctx.headers[‘referer’]获取请求头中的referer信息。通过过滤referer的方式来确保请求合法性。

* 验证码
用户在进行敏感操作时，生成一个验证码让用户输入，请求过程中将验证码携带至服务端校验。

* CSRF TOKEN
攻击者能推测出攻击对象请求地址和参数是必要条件之一，CSRF TOKEN通过阻止这一过程达到防御目的，请求参数中加入一个随机银子，也就是CSRF TOKEN，TOKEN由服务端产生存储在Session中并下发给前端，前端发起请求时传入TOKEN。

### SQL Injection
SQL注入漏洞是常见的服务端漏洞。通过SQL注入，攻击者可以从数据库获取敏感信息，或者利用数据库的特性执行高权限操作。

使用参数化查询代替SQL执行逻辑，使用参数化查询代替字符串凭借SQL语句的方式，如上在查询文章信息的示例中 ，可以采用参数化查询代替：
```
mysql.query(`select title,contet from article where id = ?`, id)
```
* 服务端参数检测
对参与SQL执行逻辑的参数进行验证，过滤容易产生SQL注入的参数值
* 避免SQL异常暴露
* 合理规划用户数据库权限

## DDoS
分布式拒绝服务攻击（Distributed Denial of service,DDoS）,以破坏应用“可用性”为目的，攻击者通过发送大量无用数据消耗有限的网络资源和服务器系统资源，导致其无法向正常用户提供服务。

### DDos防御
硬件性能提升、分布式应用部署、DDoS清洗等方案可提高应用对DDoS的防御能力。
